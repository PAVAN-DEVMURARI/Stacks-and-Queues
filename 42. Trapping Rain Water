class Solution {
public:
    int trap(vector<int>& a) {
        int n = a.size();

    stack<int> st;        
    long long water = 0;  

    for (int i = 0; i < n; ++i) {
        while (!st.empty() && a[i] > a[st.top()]) 
        {
            int bottom = st.top();
            st.pop();
            if (st.empty()) break; 
            int left = st.top();
            int distance = i - left - 1;
            int height = min(a[i], a[left]) - a[bottom];
            if (height > 0)
                water += 1LL * distance * height;
        }
        st.push(i);
    }
      return water;
    }
};
